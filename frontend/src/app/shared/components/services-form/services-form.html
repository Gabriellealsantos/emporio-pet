<div class="modal-overlay">
  <div class="modal-card" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">{{ serviceToEdit ? 'Editar Serviço' : 'Adicionar Novo Serviço' }}</h3>
      <button (click)="onClose()" class="close-button">
        <fa-icon [icon]="faTimes"></fa-icon>
      </button>
    </div>
    <form [formGroup]="serviceForm" (ngSubmit)="onSave()">
      <div class="modal-body">
        <div>
          <input type="text" formControlName="name" class="form-input" placeholder="Nome do Serviço">
          @if (f['name'].invalid && f['name'].touched) {
            <div class="error-message">
              @if (f['name'].errors?.['required']) { Nome é obrigatório. }
              @if (f['name'].errors?.['minlength']) { Deve ter no mínimo 3 caracteres. }
            </div>
          }
        </div>
        <div>
          <textarea formControlName="description" rows="3" class="form-input" placeholder="Descrição (opcional)"></textarea>
        </div>
        <div>
          <input type="text" formControlName="priceDisplay" class="form-input" placeholder="Texto de Preço (ex: R$ 80 a R$ 120)">
          @if (f['priceDisplay'].invalid && f['priceDisplay'].touched) {
            <div class="error-message">
              @if (f['priceDisplay'].errors?.['required']) { O texto de preço é obrigatório. }
            </div>
          }
        </div>
        <div>
          <input type="text" formControlName="durationDisplay" class="form-input" placeholder="Texto de Duração (ex: 60-90 min)">
          @if (f['durationDisplay'].invalid && f['durationDisplay'].touched) {
            <div class="error-message">
              @if (f['durationDisplay'].errors?.['required']) { O texto de duração é obrigatório. }
            </div>
          }
        </div>

        <div>
          <label for="imageUpload" class="form-label">Imagem do Serviço</label>
          <input id="imageUpload" type="file" (change)="onFileSelected($event)" accept="image/png, image/jpeg, image/webp" class="form-input-file">
          @if (fileName) {
            <span class="file-name">{{ fileName }}</span>
          }
        </div>

        <input type="hidden" formControlName="price">
        <input type="hidden" formControlName="estimatedDurationInMinutes">
      </div>
      <div class="modal-footer">
        <button type="button" (click)="onClose()" class="button-cancel">Cancelar</button>
        <button type="submit" [disabled]="serviceForm.invalid" class="button-save">
          {{ serviceToEdit ? 'Salvar Alterações' : 'Adicionar Serviço' }}
        </button>
      </div>
    </form>
  </div>
</div>
