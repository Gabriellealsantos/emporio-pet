<div class="modal-overlay" (click)="close.emit()">
  <div class="modal-card max-w-lg" (click)="$event.stopPropagation()">
    @if (invoice(); as inv) {
      <div class="modal-header">
        <h3 class="modal-title">Detalhes da Fatura #{{ inv.id }}</h3>
        <button (click)="close.emit()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800">
          <fa-icon [icon]="faTimes"></fa-icon>
        </button>
      </div>
      <div class="modal-body">
        <div class="space-y-3">
          <p><strong>Cliente:</strong> {{ inv.customer.name }}</p>
          <p><strong>Data:</strong> {{ inv.timestamp | date:'dd/MM/yyyy' }}</p>
          <p><strong>Status:</strong>
            <span class="px-2 py-1 text-xs font-medium rounded-full" [ngClass]="{
              'bg-yellow-100 text-yellow-800': inv.status === 'AWAITING_PAYMENT',
              'bg-green-100 text-green-800': inv.status === 'PAID'
            }">
              {{ inv.status === 'AWAITING_PAYMENT' ? 'Pendente' : 'Paga' }}
            </span>
          </p>
        </div>
        <div class="border-t mt-4 pt-4">
          <h4 class="font-semibold mb-2">Servi√ßos Cobrados:</h4>
          <div class="space-y-2">
            @for (app of inv.appointments; track app.id) {
              <div class="flex justify-between">
                <span>{{ app.service.name }} ({{ app.pet.name }})</span>
                <span>{{ app.service.price | currency:'BRL' }}</span>
              </div>
            }
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <span class="text-lg font-bold">VALOR TOTAL:</span>
        <span class="text-xl font-bold text-blue-600">{{ inv.totalAmount | currency:'BRL' }}</span>
      </div>
    } @else {
      <p class="p-6">Carregando detalhes da fatura...</p>
    }
  </div>
</div>
